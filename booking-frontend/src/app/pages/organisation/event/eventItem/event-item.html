<div class="my-5 w-full mx-auto bg-white rounded-xl shadow">
  <!-- Header -->
  <div class="flex items-center p-4">
    <img
      [src]="event.thumbnail"
      alt="event"
      class="w-20 h-20 rounded-lg object-cover"
    />
    <div class="ml-4">
      <h2 class="text-l font-semibold">{{ event.name }}</h2>
      <div class="text-sm text-gray-500 mt-1">
        <span 
          class="px-2 py-1 mr-2 rounded text-white text-sm font-medium"
          [ngClass]="getStatusClass(event.status)">
          {{ getStatusText(event.status) }}
        </span>
        <span> Bắt đầu vào: {{ event.date | date:'dd/MM/yyyy HH:mm' }}</span>
      </div>
    </div>
    <div class="ml-auto">
      <!-- Nút mở popover -->
      <p-button 
        (click)="op.toggle($event)" 
        icon="pi pi-ellipsis-v" 
        variant="text" rounded size="small" 
        title="Lựa chọn" />
    </div>
  </div>

  <!-- Tickets -->
  <div class="p-4 border-t space-y-4">
    <div *ngFor="let ticket of event.ticketTypes" class="border rounded-lg p-4 bg-gray-50">
      <div class="font-semibold text-lg">{{ ticket.name }}</div>
      <div class="flex justify-between mt-1 text-sm text-gray-600">
        <span>Giá: {{ ticket.price | number:'1.0-0' }},000 VNĐ</span>
        <span>Bán: {{ ticket.sold }} / {{ ticket.quantity }}</span>
      </div>
    </div>
  </div>
</div>



<!-- Popover -->
<p-popover #op>
  <button 
    [routerLink]="event.eventDetail?.type === 0 
      ? ['/online-event', event.id] 
      : ['/venue-event', event.id]" 
    class="flex items-center gap-2 w-full px-4 py-2 hover:bg-gray-100">
    <i class="fa-solid fa-gear"></i>
    Sửa
  </button>

  <button 
    *ngIf="event.status === 1"
    [routerLink]="['/detail-event', event.id]" 
    class="flex items-center gap-2 w-full px-4 py-2 hover:bg-gray-100">
    <i class="fa-solid fa-eye"></i>
    Xem sự kiện
  </button>

  <button 
    (click)="onCopyDraft()" 
    class="flex items-center gap-2 w-full px-4 py-2 hover:bg-gray-100">
    <i class="fa-solid fa-copy"></i>
    Nhân bản
  </button>

  <button
    *ngIf="event.status === 0 || event.status === 1"
    (click)="this.showConfirm = true" 
    class="flex items-center gap-2 w-full px-4 py-2 hover:bg-gray-100">
    <i 
      class="fa-solid" 
      [ngClass]="event.status === 0 ? 'fa-trash' : 'fa-ban'">
    </i>
    {{ event.status === 0 ? 'Xóa' : 'Hủy' }}
  </button>
</p-popover>

<app-popup
  [show]="showConfirm"
  title="Xác nhận"
  message="Bạn có muốn hủy sự kiện này?"
  (confirm)="onDelete()"
  (cancel)="onDeleteCancelled()">
</app-popup>